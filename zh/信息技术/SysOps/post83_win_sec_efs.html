<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.60" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://blog.solex-inc.com/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html"><meta property="og:site_name" content="Tim's Blog"><meta property="og:title" content="Windows：文件加密：EFS和PKI"><meta property="og:description" content="前言 很多企业，信息安全工作的工作重点就是防泄密，而文件加密就是防泄密重要一环。 商业解决方案有很多种，比较重的有Symantec PGP 磁盘加密，还有其他。普通的可以选择Windows Bitlocker分区和文件加密，以及基于用户的Windows EFS文件加密。 本文主要介绍使用EFS，Bitlocker和 EFS的比较放在文末。 闲话：有的企业不仅要防普通员工，还要防IT人员，为什么呢？ IT的系统权限太大。 好像什么都可以访问，比如还能远程打开Windows管理共享 \\boss_pc\c$, 如果碰上一些没有职业操守的IT，后果就严重了，高管听说后都吓坏了。另外，商业竞争白热化情况下，竞争对手（或是其他机构）雇佣专业人员到你企业“卧底”成IT人员，然后就...都是道听途说的。"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-02-06T00:30:59.000Z"><meta property="article:tag" content="efs"><meta property="article:tag" content="pki"><meta property="article:tag" content="Information Security"><meta property="article:published_time" content="2024-02-05T00:00:00.000Z"><meta property="article:modified_time" content="2024-02-06T00:30:59.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Windows：文件加密：EFS和PKI","image":[""],"datePublished":"2024-02-05T00:00:00.000Z","dateModified":"2024-02-06T00:30:59.000Z","author":[]}</script><title>Windows：文件加密：EFS和PKI | Tim's Blog</title><meta name="description" content="前言 很多企业，信息安全工作的工作重点就是防泄密，而文件加密就是防泄密重要一环。 商业解决方案有很多种，比较重的有Symantec PGP 磁盘加密，还有其他。普通的可以选择Windows Bitlocker分区和文件加密，以及基于用户的Windows EFS文件加密。 本文主要介绍使用EFS，Bitlocker和 EFS的比较放在文末。 闲话：有的企业不仅要防普通员工，还要防IT人员，为什么呢？ IT的系统权限太大。 好像什么都可以访问，比如还能远程打开Windows管理共享 \\boss_pc\c$, 如果碰上一些没有职业操守的IT，后果就严重了，高管听说后都吓坏了。另外，商业竞争白热化情况下，竞争对手（或是其他机构）雇佣专业人员到你企业“卧底”成IT人员，然后就...都是道听途说的。">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-ed124a17.css" as="style"><link rel="stylesheet" href="/assets/style-ed124a17.css">
    <link rel="modulepreload" href="/assets/app-bd98ceea.js"><link rel="modulepreload" href="/assets/framework-b5535326.js"><link rel="modulepreload" href="/assets/post83_win_sec_efs.html-f7ee1467.js"><link rel="modulepreload" href="/assets/post83_win_sec_efs.html-8dc667a6.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/avatar.JPG" alt="Tim&#39;s Blog"><!----><span class="site-name hide-in-pad">Tim&#39;s Blog</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/zh/" class="nav-link active" aria-label="博客主页"><span class="font-icon icon iconfont icon-home" style=""></span>博客主页<!----></a></div><div class="nav-item hide-in-mobile"><a href="/zh/%E7%94%9F%E6%B4%BB%E9%9A%8F%E7%AC%94/" class="nav-link" aria-label="生活随笔"><span class="font-icon icon iconfont icon-discover" style=""></span>生活随笔<!----></a></div><div class="nav-item hide-in-mobile"><a href="/zh/%E5%A4%96%E8%AF%AD%E5%AD%A6%E4%B9%A0/" class="nav-link" aria-label="外语学习"><span class="font-icon icon iconfont icon-discover" style=""></span>外语学习<!----></a></div><div class="nav-item hide-in-mobile"><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/" class="nav-link active" aria-label="信息技术"><span class="font-icon icon iconfont icon-edit" style=""></span>信息技术<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/100vision/100vision.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/" class="nav-link sidebar-link sidebar-page" aria-label="Blog Home"><span class="font-icon icon iconfont icon-home" style=""></span>Blog Home<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><p class="sidebar-heading active"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">文章</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/zh/" class="nav-link sidebar-link sidebar-page" aria-label="博客主页"><span class="font-icon icon iconfont icon-home" style=""></span>博客主页<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">信息技术</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Database</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Dev Ops</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">Sys Ops</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/linux_shell_cookbook.html" class="nav-link sidebar-link sidebar-page" aria-label="Linux：很牛B的一些Shell命令"><span class="font-icon icon iconfont icon-page" style=""></span>Linux：很牛B的一些Shell命令<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/ps_list_dfs_target_folders.html" class="nav-link sidebar-link sidebar-page" aria-label="Powershell：列出所有DFS命名空间下的共享文件夹"><span class="font-icon icon iconfont icon-page" style=""></span>Powershell：列出所有DFS命名空间下的共享文件夹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/messaging_antispam_amavisd.html" class="nav-link sidebar-link sidebar-page" aria-label="反垃圾邮件系列：Amavisd处理垃圾邮件几个Levels"><span class="font-icon icon iconfont icon-page" style=""></span>反垃圾邮件系列：Amavisd处理垃圾邮件几个Levels<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/linux_rsync.html" class="nav-link sidebar-link sidebar-page" aria-label="工具：rsync注意事项:非ASCII 会报&quot;invalid argument&quot;"><span class="font-icon icon iconfont icon-page" style=""></span>工具：rsync注意事项:非ASCII 会报&quot;invalid argument&quot;<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/linux_basis_fd.html" class="nav-link sidebar-link sidebar-page" aria-label="Linux基础：什么是文件描述符和工具lsof"><span class="font-icon icon iconfont icon-page" style=""></span>Linux基础：什么是文件描述符和工具lsof<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/vmware_horizon_01.html" class="nav-link sidebar-link sidebar-page" aria-label="VMware Horizon：FSLogix配置管理和App Volumes应用交付"><span class="font-icon icon iconfont icon-page" style=""></span>VMware Horizon：FSLogix配置管理和App Volumes应用交付<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/chrome_extension_push_install.html" class="nav-link sidebar-link sidebar-page" aria-label="Google Chrome：扩展的推送安装(Push Install)"><span class="font-icon icon iconfont icon-page" style=""></span>Google Chrome：扩展的推送安装(Push Install)<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/win_sccm_troubleshooting_1.html" class="nav-link sidebar-link sidebar-page" aria-label="SCCM：问题排查1：跟踪部署策略的执行过程"><span class="font-icon icon iconfont icon-page" style=""></span>SCCM：问题排查1：跟踪部署策略的执行过程<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/win_sccm_tools_01.html" class="nav-link sidebar-link sidebar-page" aria-label="SCCM：效率工具：RECAST Software的Right Click Tools"><span class="font-icon icon iconfont icon-page" style=""></span>SCCM：效率工具：RECAST Software的Right Click Tools<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/win_sccm_troubleshooting_2.html" class="nav-link sidebar-link sidebar-page" aria-label="SCCM：问题排查2：有用的SCCM管理命令行"><span class="font-icon icon iconfont icon-page" style=""></span>SCCM：问题排查2：有用的SCCM管理命令行<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/ps_how_to_new_ps_object.html" class="nav-link sidebar-link sidebar-page" aria-label="Powershell：基础:自定义对象1：使用PSCustomObject"><span class="font-icon icon iconfont icon-page" style=""></span>Powershell：基础:自定义对象1：使用PSCustomObject<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/win_sccm_tools_02.html" class="nav-link sidebar-link sidebar-page" aria-label="SCCM：效率工具：SCCM CMPivot报表工具"><span class="font-icon icon iconfont icon-page" style=""></span>SCCM：效率工具：SCCM CMPivot报表工具<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/win_ad_troubleshooting_01.html" class="nav-link sidebar-link sidebar-page" aria-label="活动目录：DFSR SysVol (Domain Sysvol Volumes)丢失问题"><span class="font-icon icon iconfont icon-page" style=""></span>活动目录：DFSR SysVol (Domain Sysvol Volumes)丢失问题<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post34_win_sccm_troubleshooting_3.html" class="nav-link sidebar-link sidebar-page" aria-label="SCCM：问题排查2：CCM 客户端安装错误：&quot;Setup with Failed through BITS. Error 0x80080005&quot;"><span class="font-icon icon iconfont icon-page" style=""></span>SCCM：问题排查2：CCM 客户端安装错误：&quot;Setup with Failed through BITS. Error 0x80080005&quot;<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post38_backup_nbu_01.html" class="nav-link sidebar-link sidebar-page" aria-label="数据保护：Netbackup：使用Automatic Image Replication (AIR)"><span class="font-icon icon iconfont icon-page" style=""></span>数据保护：Netbackup：使用Automatic Image Replication (AIR)<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post38_backup_nbu_02.html" class="nav-link sidebar-link sidebar-page" aria-label="数据保护：Netbackup：解决 CA Host-ID获取证书失败：Error 8504"><span class="font-icon icon iconfont icon-page" style=""></span>数据保护：Netbackup：解决 CA Host-ID获取证书失败：Error 8504<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post43_win_accounts_intro.html" class="nav-link sidebar-link sidebar-page" aria-label="Windows：特殊账户管理：了解服务账户、虚拟账户和可管理服务账户"><span class="font-icon icon iconfont icon-page" style=""></span>Windows：特殊账户管理：了解服务账户、虚拟账户和可管理服务账户<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post44_win_build_a_simple_http.html" class="nav-link sidebar-link sidebar-page" aria-label="Windows：效率工具：使用Node.js Express快速部署一个简单Web服务器"><span class="font-icon icon iconfont icon-page" style=""></span>Windows：效率工具：使用Node.js Express快速部署一个简单Web服务器<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post53_msg_exchange_roles_intro.html" class="nav-link sidebar-link sidebar-page" aria-label="Exchange Server系列：RBAC 介绍Exchange Server管理角色"><span class="font-icon icon iconfont icon-page" style=""></span>Exchange Server系列：RBAC 介绍Exchange Server管理角色<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post55_sec_file_auditing_01.html" class="nav-link sidebar-link sidebar-page" aria-label="工具介绍系列：安全审计 ManageEngine ADAudit Plus"><span class="font-icon icon iconfont icon-page" style=""></span>工具介绍系列：安全审计 ManageEngine ADAudit Plus<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post57_msg_exchange_autodiscovery.html" class="nav-link sidebar-link sidebar-page" aria-label="Exchange Server系列：自动发现服务"><span class="font-icon icon iconfont icon-page" style=""></span>Exchange Server系列：自动发现服务<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post64_ops_vmware_02.html" class="nav-link sidebar-link sidebar-page" aria-label="服务器虚拟化系列：VMWare:虚拟机快照"><span class="font-icon icon iconfont icon-page" style=""></span>服务器虚拟化系列：VMWare:虚拟机快照<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post65_ops_vmware_01.html" class="nav-link sidebar-link sidebar-page" aria-label="服务器虚拟化系列：VMWare:虚拟机磁盘文件"><span class="font-icon icon iconfont icon-page" style=""></span>服务器虚拟化系列：VMWare:虚拟机磁盘文件<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post66_msg_postfix_antispam_01.html" class="nav-link sidebar-link sidebar-page" aria-label="Postfix系列：防垃圾邮件：SpamAssassin： Bayes实现自动投喂垃圾邮件"><span class="font-icon icon iconfont icon-page" style=""></span>Postfix系列：防垃圾邮件：SpamAssassin： Bayes实现自动投喂垃圾邮件<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post74_win_tools_remoting_01.html" class="nav-link sidebar-link sidebar-page" aria-label="工具介绍系列：远程控制：远程控制Android安卓设备"><span class="font-icon icon iconfont icon-page" style=""></span>工具介绍系列：远程控制：远程控制Android安卓设备<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post77_backup_nbu_03.html" class="nav-link sidebar-link sidebar-page" aria-label="数据保护：Netbackup：Netbackup进程"><span class="font-icon icon iconfont icon-page" style=""></span>数据保护：Netbackup：Netbackup进程<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post79_tools_media_ffmpeg_01.html" class="nav-link sidebar-link sidebar-page" aria-label="工具介绍系列：多媒体：ffmpeg"><span class="font-icon icon iconfont icon-page" style=""></span>工具介绍系列：多媒体：ffmpeg<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post80_backup_nbu_04.html" class="nav-link sidebar-link sidebar-page" aria-label="数据保护：Netbackup：Netbackup网络通讯问题排错"><span class="font-icon icon iconfont icon-page" style=""></span>数据保护：Netbackup：Netbackup网络通讯问题排错<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Windows：文件加密：EFS和PKI"><span class="font-icon icon iconfont icon-page" style=""></span>Windows：文件加密：EFS和PKI<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html#前言" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="前言"><!---->前言<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html#正文" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="正文"><!---->正文<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html#简单介绍" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="简单介绍"><!---->简单介绍<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html#普通使用" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="普通使用"><!---->普通使用<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html#最佳实践" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="最佳实践"><!---->最佳实践<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html#扩展-bitlocker-vs-encrypting-file-system-efs" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="扩展：BitLocker vs. Encrypting File System (EFS)"><!---->扩展：BitLocker vs. Encrypting File System (EFS)<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html#参考" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="参考"><!---->参考<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">编程</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">网络</span><span class="arrow end"></span></button><!----></section></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">外语学习</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">生活随笔</span><span class="arrow end"></span></button><!----></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="font-icon icon iconfont icon-page" style=""></span>Windows：文件加密：EFS和PKI</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://blog.solex-inc.com" target="_blank" rel="noopener noreferrer">tlin82</a></span><span property="author" content="tlin82"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-02-05T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 9 分钟</span><meta property="timeRequired" content="PT9M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="page-category-item category6 clickable" role="navigation">Windows</span><span class="page-category-item category4 clickable" role="navigation">文件加密</span><span class="page-category-item category4 clickable" role="navigation">信息安全</span><meta property="articleSection" content="Windows,文件加密,信息安全"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><span class="page-tag-item tag1 clickable" role="navigation">efs</span><span class="page-tag-item tag4 clickable" role="navigation">pki</span><span class="page-tag-item tag8 clickable" role="navigation">Information Security</span><meta property="keywords" content="efs,pki,Information Security"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容<button class="print-button" title="print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html#前言" class="router-link-active router-link-exact-active toc-link level2">前言</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html#正文" class="router-link-active router-link-exact-active toc-link level2">正文</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html#简单介绍" class="router-link-active router-link-exact-active toc-link level3">简单介绍</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html#普通使用" class="router-link-active router-link-exact-active toc-link level3">普通使用</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html#最佳实践" class="router-link-active router-link-exact-active toc-link level3">最佳实践</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html#扩展-bitlocker-vs-encrypting-file-system-efs" class="router-link-active router-link-exact-active toc-link level2">扩展：BitLocker vs. Encrypting File System (EFS)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post83_win_sec_efs.html#参考" class="router-link-active router-link-exact-active toc-link level2">参考</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h2 id="前言" tabindex="-1"><a class="header-anchor" href="#前言" aria-hidden="true">#</a> 前言</h2><p>很多企业，信息安全工作的工作重点就是防泄密，而文件加密就是防泄密重要一环。</p><p>商业解决方案有很多种，比较重的有<code>Symantec PGP </code>磁盘加密，还有其他。普通的可以选择<code>Windows Bitlocker</code>分区和文件加密，以及基于用户的<code>Windows EFS</code>文件加密。 本文主要介绍使用EFS，Bitlocker和 EFS的比较放在文末。</p><blockquote><p>闲话：有的企业不仅要防普通员工，还要防IT人员，为什么呢？ IT的系统权限太大。 好像什么都可以访问，比如还能远程打开Windows管理共享 <code>\\boss_pc\c$</code>, 如果碰上一些没有职业操守的IT，后果就严重了，高管听说后都吓坏了。另外，商业竞争白热化情况下，竞争对手（或是其他机构）雇佣专业人员到你企业“卧底”成IT人员，然后就...都是道听途说的。</p></blockquote><h2 id="正文" tabindex="-1"><a class="header-anchor" href="#正文" aria-hidden="true">#</a> 正文</h2><blockquote><p>EFS, <code>Encrypted File System</code>，使用的是公钥对文件进行加密,是比较可靠的加密选项。</p></blockquote><h3 id="简单介绍" tabindex="-1"><a class="header-anchor" href="#简单介绍" aria-hidden="true">#</a> 简单介绍</h3><ul><li>使用的是用户公钥对文件进行加密，不是普通的密码保护；</li><li>不需要硬件支持；</li><li>需要NTFS文件系统；</li><li>加密后的文件，用户透明访问；其他用户则打不开，拷贝到其他位置或其他系统（重装系统）也不行。</li></ul><h3 id="普通使用" tabindex="-1"><a class="header-anchor" href="#普通使用" aria-hidden="true">#</a> 普通使用</h3><ul><li>选择一个要加密的文件夹，【属性】、【高级】</li><li>勾起【加密内容以便保护数据】</li><li>这样文件就加密好了；加密后的文件上图标有一把黄色小锁，如下图： <img src="/assets/post83_encypted_file-362dbcd7.png" alt="图：加密后的文件" loading="lazy"></li><li>备份和保管好证书私钥，以防系统重装或证书丢失后打不开加密文件；</li></ul><h3 id="最佳实践" tabindex="-1"><a class="header-anchor" href="#最佳实践" aria-hidden="true">#</a> 最佳实践</h3><blockquote><p>最佳实践适合应用到企业。</p></blockquote><ul><li>准备AD域环境</li><li>准备部署企业证书CA</li><li>准备企业CA的EFS恢复代理证书模板</li><li>准备企业CA的用户EFS加密证书模板</li><li>指定企业EFS的恢复代理Data Recovery Agent(DRA)（用户证书丢失的备用恢复解决方案）</li></ul><p><strong>1、准备AD域环境</strong></p><p>步骤略。企业一般都有AD域环境。有了AD部署组策略和证书颁发都很方便；</p><p><strong>2、准备部署企业证书CA机构</strong></p><blockquote><p>步骤略，主要像说说CA的重要和好处。</p></blockquote><p>即企业内部CA，用Windows证书服务机构即可，可以多级。有了内部CA，好处多多，可以根据不同需要创建证书模板：</p><ul><li>内部有需要使用SSL加密通讯的Web服务都可以申请、颁发。</li><li>本文会使用EFS加密也可以使用指定用户证书模板和恢复代理模板；</li><li>802.1X/Radius认证、网络接入也可以使用，比较计算机证书模板；</li></ul><p><strong>3、准备EFS恢复代理证书模板</strong></p><blockquote><p>目的：即指定1个或多个企业（组织）内的EFS恢复代理用户，这样即使用户的证书弄丢了，使用EFS恢复代理用户的证书来解密文件。</p></blockquote><ul><li>登录CA服务器打开CA机构，找到【文件恢复代理】模板，复制1份，并重命名例如&quot;MY_EFS_dra_certificates&quot;。</li><li>【常规】，指定设置有效期，例如10年；</li><li>【常规】 勾上“允许发布到Active Directory&quot; （可选）</li><li>【安全】，指定可以申请该证书的用户或组，一般是给域管理员，例如<code>Administrator</code>,确保ACL授权给用户或组勾上【申请】或【Enroll】。注意：勾掉其他用户；如下图： <img src="/assets/post83_ca_template-permissions-89603284.png" alt="指定证书模板权限" loading="lazy"></li></ul><p><strong>4、 准备用户的EFS证书模板</strong></p><blockquote><p>目的：准备用户的EFS证书模板给用户申请或自动颁发，用户申请到这个证书后就可以用来加密自己的文件。</p></blockquote><ul><li>打开CA机构，找到【用户】模板，复制1份，并重命名例如&quot;MY_EFS_User_certificates&quot;。我们选择这个模板而不是【EFS既不加密】模板，是因为这个模板的使用范围比较大，可以做文件加密用途，也可以做客户端身份验证，详见它的OID。</li><li>同样，设置模板属性，名称和有效期；</li><li>最重要的是，设置【安全】标签下的ACL， 我们允许所有【Authenticated Users】可以【申请】或【Enroll】；</li></ul><p><strong>5、准备EFS恢复代理证书</strong></p><blockquote><p>目的: 需要准备一份EFS恢复代理证书，这证书要发放到所有域计算机，有可能使用EFS加密的系统上。</p></blockquote><ul><li>使用EFS恢复代理模板指定的授权账户登录到域控制器或是任意一台其他域成员服务器，在本例是<code>Administrator</code>。</li><li>启动<code>certmgr.msc</code>证书管理，展开【个人】、【证书】。右键【申请新证书】。</li><li>证书注册向导，选择【Active Directory】注册策略，【下一步】</li><li>选择 【恢复代理证书】模板，在本例是【My_EFS_DRA_Certificate】，完成步骤。</li></ul><div class="hint-container tip"><p class="hint-container-title">提示</p><p>如果申请时不见该模板，一般是在准备EFS恢复模板时，没有给对权限。</p></div><ul><li>完成证书安装；</li><li>右键选择【导出】证书。导出时，注意选择【同时导出私钥】。最后，导出的密钥文件一般是<code>xxx.pfx</code></li></ul><div class="hint-container note"><p class="hint-container-title">注</p><p>导出时注意可以考虑使用密码保护以及指定用户或组加强密钥安全。</p></div><p><strong>6、发布和部署企业EFS恢复代理</strong></p><blockquote><p>目的：EFS恢复代理要下发到域计算机上，这样用户加密文件时才会把恢复代理加进去文件中，多一般钥匙。</p></blockquote><ul><li>把前面导出的恢复代理证书拷贝；</li><li>通过组策略，可以使用默认域策略也可以新建一个专门的组策略；</li><li>编辑组策略，【计算机配置】，【安全配置】、【EFS】</li><li>新增EFS恢复代理程序，指定pfx文件；</li></ul><p><strong>7、用户申请EFS证书加密</strong></p><blockquote><p>域用户登录自己计算机后，即可申请CA发布的EFS证书或是自动申请；</p></blockquote><ul><li>启动<code>certmgr.msc</code>证书管理，展开【个人】、【证书】。右键【申请新证书】。</li><li>证书注册向导，选择【Active Directory】注册策略，【下一步】</li><li>选择 【用户】模板，在本例是【My_EFS_User_Certificate】，完成步骤。</li></ul><div class="hint-container tip"><p class="hint-container-title">提示</p><p>如果申请时不见该模板，一般是在准备EFS恢复模板时，没有给对权限。</p></div><p><strong>8、开始加密文件和文件夹</strong></p><p>步骤可以参考可以参考文章开头的【简单使用】。</p><p><strong>9、附加：备份EFS证书密钥</strong></p><div class="hint-container warning"><p class="hint-container-title">注意</p><p>备份EFS证书密钥很重要，否则系统重装后证书就没有了，加密文件会打不开。即使用户重新申请证书也没用，因为新证书也无法无权限解密。</p></div><ul><li>EFS恢复代理管理员通过证书管理单元导出证书和私钥即可，然后保存到一个安全位置；</li><li>用户同样通过证书管理单元导出证书和私钥即可，然后保存到一个安全位置；用户重装了操作系统或丢失了备份证书私钥，可以寻求EFS恢复代理管理员帮忙解密文件。</li></ul><div class="hint-container note"><p class="hint-container-title">注</p><p>注意保管好证书和私钥，考虑使用密码保护。如果不慎被其他人拿到，其他人则可以访问加密文件。</p></div><p><strong>10、EFS恢复代理管理员如何协助用户解密</strong></p><ul><li>EFS恢复代理管理员登录到用户计算机；</li><li>EFS恢复代理管理员把自己备份的证书私钥导入到用户计算机；</li><li>把加密文件和加密文件夹即可解密或使用<code>cipher /d</code>命令行工具；</li></ul><p><strong>11、常见问题</strong></p><blockquote><p>EFS恢复代理也不能解密文件。</p></blockquote><p>原因1：用户加密前，没有指定EFS恢复代理。</p><p>解决办法：如果用户也没有备份证书，没有办法解密，因此备份证书很重要。</p><p>原因2：使用错误的EFS恢复代理证书可能会解密失败，即用户加密时的EFS恢复代理证书和尝试解密的EFS证书不是同一个。</p><p>解决办法：</p><p>务必使用正确的恢复代理证书。通过对证书的指纹thumbprint来验证证书是否同一个， 步骤：</p><ul><li>检查解密出问题的加密文件的属性，文件的加密属性里【详细信息】，可以看到加密时指定的EFS恢复代理证书和指纹。如下图：</li></ul><figure><img src="/assets/post83_efs_dra_thumbprint_when_encrypted-03657edc.png" alt="图：检查加密时的使用EFS恢复代理证书指纹" tabindex="0" loading="lazy"><figcaption>图：检查加密时的使用EFS恢复代理证书指纹</figcaption></figure><ul><li>检查导入的EFS恢复代理的证书指纹。如下图：</li></ul><figure><img src="/assets/post83_efs_dra_thumbprint_when_recovered-8bf02486.png" alt="图：检查导入的EFS恢复代理证书指纹" tabindex="0" loading="lazy"><figcaption>图：检查导入的EFS恢复代理证书指纹</figcaption></figure><h2 id="扩展-bitlocker-vs-encrypting-file-system-efs" tabindex="-1"><a class="header-anchor" href="#扩展-bitlocker-vs-encrypting-file-system-efs" aria-hidden="true">#</a> 扩展：BitLocker vs. Encrypting File System (EFS)</h2><blockquote><p>Bitlocker比较适合外置磁盘加密，例如U盘</p></blockquote><pre><code>BitLocker encrypts all personal and system files on the drive where Windows is installed, or on data drives on the same computer.
EFS encrypts individual files on any drive.
BitLocker does not depend on the individual user accounts associated with files. BitLocker is either on or off, for all users or groups.
EFS encrypts files based on the user account associated with it. If a computer has multiple users or groups, each can encrypt their own files independently.
BitLocker uses the Trusted Platform Module (TPM), a special microchip in some newer computers that supports advanced security features.
EFS does not require or use any special hardware.
You must be an administrator to turn BitLocker encryption on or off once it&#39;s enabled.
You do not have to be an administrator to use EFS.
You can use BitLocker Drive Encryption and the Encrypting File System together to get the protection offered by both features. When using EFS, encryption keys are stored with the computer&#39;s operating system. While these are encrypted, that level of security could potentially be compromised if a hacker is able to boot or access the system drive. Using BitLocker to encrypt the system drive can help protect these keys by preventing the system drive from booting or being accessed if it is installed into another computer.
</code></pre><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考" aria-hidden="true">#</a> 参考</h2><ul><li><p><a href="https://superuser.com/questions/527010/what-are-differences-between-efs-and-bitlocker-in-windows" target="_blank" rel="noopener noreferrer">Stackflow: What are differences between EFS and BitLocker in Windows?<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li><li><p><a href="https://www.rootusers.com/configure-efs-recovery-agent/" target="_blank" rel="noopener noreferrer">RouteUser:Configure the EFS Recovery Agent<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li></ul></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/100vision/100vision.github.io/edit/main/src/zh/信息技术/SysOps/post83_win_sec_efs.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: lin.tixiang@gmail.com">100vision</span>,<!--]--><!--[--><span class="contributor" title="email: 30432527+100vision@users.noreply.github.com">100vision</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><a href="/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/post80_backup_nbu_04.html" class="nav-link prev" aria-label="数据保护：Netbackup：Netbackup网络通讯问题排错"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><span class="font-icon icon iconfont icon-page" style=""></span>数据保护：Netbackup：Netbackup网络通讯问题排错</div></a><!----></nav><div class="giscus-wrapper input-top" id="comment" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">由 <a href="https://theme-hope.vuejs.press" target="_blank">Theme Hope</a> 驱动</div><div class="copyright">Copyright © 2024 tlin82</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-bd98ceea.js" defer></script>
  </body>
</html>
