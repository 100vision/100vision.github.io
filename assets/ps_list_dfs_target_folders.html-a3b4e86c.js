const e=JSON.parse(`{"key":"v-56f9dc9e","path":"/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/ps_list_dfs_target_folders.html","title":"Powershell：列出所有DFS命名空间下的共享文件夹","lang":"zh-CN","frontmatter":{"title":"Powershell：列出所有DFS命名空间下的共享文件夹","icon":"page","order":5,"date":"2023-02-15T00:00:00.000Z","category":["Windows","Powershell"],"tag":["Powershell","脚本编程","转载"],"sticky":false,"star":true,"description":"脚本功能： 列出所有DFS空间下的共享目标文件夹 前提条件 需要安装DFSN模块到Powershell 1、安装DFSN模块 Windows 2012 管理可选特色 添加功能 选择RSAT 文件服务工具 2、脚本内容 function Get-DfsnAllFolderTargets () { #Get a list of all Namespaces in the Domain Write-Progress -Activity \\"1/3 - Getting List of Domain NameSpaces\\" $RootList = Get-DfsnRoot -ComputerName dfs-serer-name #Get a list of all FolderPaths in the Namespaces Write-Progress -Activity \\"2/3 - Getting List of Domain Folder Paths\\" $FolderPaths = foreach ($item in $RootList) { Get-DfsnFolder -Path \\"$($item.path)\\\\*\\" } #Get a list of all Folder Targets in the Folder Paths, in the Namespaces\\" Write-Progress -Activity \\"2/3 - Getting List of Folder Targets\\" $FolderTargets = foreach ($item in $FolderPaths) { Get-DfsnFolderTarget -Path $item.Path } return $FolderTargets } Get-DfsnAllFolderTargets | Export-Csv -Path D:\\\\temp\\\\dfs_targets.csv -Encoding UTF8 -NoTypeInformation","head":[["meta",{"property":"og:url","content":"https://blog.solex-inc.com/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/SysOps/ps_list_dfs_target_folders.html"}],["meta",{"property":"og:site_name","content":"Tim's Blog"}],["meta",{"property":"og:title","content":"Powershell：列出所有DFS命名空间下的共享文件夹"}],["meta",{"property":"og:description","content":"脚本功能： 列出所有DFS空间下的共享目标文件夹 前提条件 需要安装DFSN模块到Powershell 1、安装DFSN模块 Windows 2012 管理可选特色 添加功能 选择RSAT 文件服务工具 2、脚本内容 function Get-DfsnAllFolderTargets () { #Get a list of all Namespaces in the Domain Write-Progress -Activity \\"1/3 - Getting List of Domain NameSpaces\\" $RootList = Get-DfsnRoot -ComputerName dfs-serer-name #Get a list of all FolderPaths in the Namespaces Write-Progress -Activity \\"2/3 - Getting List of Domain Folder Paths\\" $FolderPaths = foreach ($item in $RootList) { Get-DfsnFolder -Path \\"$($item.path)\\\\*\\" } #Get a list of all Folder Targets in the Folder Paths, in the Namespaces\\" Write-Progress -Activity \\"2/3 - Getting List of Folder Targets\\" $FolderTargets = foreach ($item in $FolderPaths) { Get-DfsnFolderTarget -Path $item.Path } return $FolderTargets } Get-DfsnAllFolderTargets | Export-Csv -Path D:\\\\temp\\\\dfs_targets.csv -Encoding UTF8 -NoTypeInformation"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-02-15T01:05:51.000Z"}],["meta",{"property":"article:tag","content":"Powershell"}],["meta",{"property":"article:tag","content":"脚本编程"}],["meta",{"property":"article:tag","content":"转载"}],["meta",{"property":"article:published_time","content":"2023-02-15T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-02-15T01:05:51.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Powershell：列出所有DFS命名空间下的共享文件夹\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-02-15T00:00:00.000Z\\",\\"dateModified\\":\\"2023-02-15T01:05:51.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":3,"title":"脚本功能： 列出所有DFS空间下的共享目标文件夹","slug":"脚本功能-列出所有dfs空间下的共享目标文件夹","link":"#脚本功能-列出所有dfs空间下的共享目标文件夹","children":[]},{"level":3,"title":"1、安装DFSN模块","slug":"_1、安装dfsn模块","link":"#_1、安装dfsn模块","children":[]},{"level":3,"title":"2、脚本内容","slug":"_2、脚本内容","link":"#_2、脚本内容","children":[]},{"level":3,"title":"原创链接","slug":"原创链接","link":"#原创链接","children":[]}],"git":{"createdTime":1676422860000,"updatedTime":1676423151000,"contributors":[{"name":"100vision","email":"lin.tixiang@gmail.com","commits":2}]},"readingTime":{"minutes":1.02,"words":305},"filePathRelative":"zh/信息技术/SysOps/ps_list_dfs_target_folders.md","localizedDate":"2023年2月15日","excerpt":"<h3> 脚本功能： 列出所有DFS空间下的共享目标文件夹</h3>\\n<div class=\\"hint-container tip\\">\\n<p class=\\"hint-container-title\\">前提条件</p>\\n<p>需要安装DFSN模块到Powershell</p>\\n</div>\\n<h3> 1、安装DFSN模块</h3>\\n<ul>\\n<li>Windows 2012 管理可选特色</li>\\n<li>添加功能</li>\\n<li>选择RSAT 文件服务工具</li>\\n</ul>\\n<h3> 2、脚本内容</h3>\\n<div class=\\"language-Powershell line-numbers-mode\\" data-ext=\\"Powershell\\"><pre class=\\"language-Powershell\\"><code>function Get-DfsnAllFolderTargets ()\\n{\\n    #Get a list of all Namespaces in the Domain\\n    Write-Progress -Activity \\"1/3 - Getting List of Domain NameSpaces\\"\\n    $RootList = Get-DfsnRoot -ComputerName dfs-serer-name\\n\\n    #Get a list of all FolderPaths in the Namespaces\\n    Write-Progress -Activity \\"2/3 - Getting List of Domain Folder Paths\\"\\n    $FolderPaths = foreach ($item in $RootList)\\n    {\\n        Get-DfsnFolder -Path \\"$($item.path)\\\\*\\"\\n    }\\n\\n    #Get a list of all Folder Targets in the Folder Paths, in the Namespaces\\"\\n    Write-Progress -Activity \\"2/3 - Getting List of Folder Targets\\"\\n    $FolderTargets = foreach ($item in $FolderPaths)\\n    {\\n        Get-DfsnFolderTarget -Path $item.Path    \\n    }\\n    return $FolderTargets\\n}\\nGet-DfsnAllFolderTargets | Export-Csv -Path D:\\\\temp\\\\dfs_targets.csv -Encoding UTF8 -NoTypeInformation\\n</code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}`);export{e as data};
