import{_ as e,W as i,X as t,Y as a}from"./framework-b5535326.js";const n="/assets/Post55_sec__adauditPlus_SVM_AD_Obj_Attri_Operatingsystem_before_change-38dd37e9.jpg",s="/assets/Post55_sec__adauditPlus_SVM_AD_Obj_Attri_Operatingsystem_after_change-fbf592b3.jpg",l={},d=a(`<h2 id="前言" tabindex="-1"><a class="header-anchor" href="#前言" aria-hidden="true">#</a> 前言</h2><p>介绍一款安全审计工具<code>ManageEngine ADAudit Plus</code>，</p><blockquote><p>Tracking file and folder modifications with ADAudit Plus</p></blockquote><p>主要支持：</p><ul><li>活动目录审计</li><li>文件系统审计。</li></ul><h2 id="一、活动目录审计" tabindex="-1"><a class="header-anchor" href="#一、活动目录审计" aria-hidden="true">#</a> 一、活动目录审计</h2><p>审计项目：</p><ul><li>AD用户对象变更，例如：（用户账户/计算机账户创建、删除、登录活动异常分析、账户锁定等）</li><li>AD组对象变更。例如成员变更等；</li><li>组策略对象的变更等</li></ul><h2 id="二、文件系统审计" tabindex="-1"><a class="header-anchor" href="#二、文件系统审计" aria-hidden="true">#</a> 二、文件系统审计</h2><p>审计对象：</p><ul><li>文件和文件夹的变更。例如添加/删除/移动/修改等；</li></ul><p>支持：</p><ul><li>Windows文件服务器</li><li>NetApp Ontap (Cluster)</li><li>联想凌拓Lenovo Release (需要特殊配置)</li></ul><h2 id="安装和配置" tabindex="-1"><a class="header-anchor" href="#安装和配置" aria-hidden="true">#</a> 安装和配置</h2><p>简单不介绍，安装后，几乎是开箱即用。</p><h2 id="文件系统审计和联想凌拓nas集成" tabindex="-1"><a class="header-anchor" href="#文件系统审计和联想凌拓nas集成" aria-hidden="true">#</a> 文件系统审计和联想凌拓NAS集成</h2><p>之所以单独讲联想凌拓NAS，是因为如果不做特殊配置，ADAudit Plus无法做文件审计联想凌拓NAS文件活动。</p><p><strong>具体问题</strong></p><p>凌拓NAS虽然运行的系统也是ONTAP，但还是有些不同。例如：VServer(SVM)加入活动目录后，会在目录中创建一个AD计算机对象。但ADAudit Plus无法在AD活动目录中发现搜索这个SVM，你通过ADAudit配置NetApp服务器向导会看到：</p><blockquote><p>&quot; No Active Directory Objects available.&quot;</p></blockquote><p>意思是NAS SVM没有发现，这样向导就没法继续配置发现NAS上的共享了和开启审核。</p><ul><li>查看NAS端的审计配置</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>MyFileCluster::&gt; vserver audit show -vserver svm_cifs

                           Vserver: svm_cifs
                    Auditing State: true
              Log Destination Path: /vol_sys_auditing
     Categories of Events to Audit: file-ops, audit-policy-change
                        Log Format: evtx
               Log File Size Limit: 200MB
      Log Rotation Schedule: Month: -
Log Rotation Schedule: Day of Week: -
        Log Rotation Schedule: Day: -
       Log Rotation Schedule: Hour: -
     Log Rotation Schedule: Minute: -
                Rotation Schedules: -
          Log Files Rotation Limit: 5
            Log Retention Duration: 0s
      Strict Guarantee of Auditing: true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>再看看NAS端的SVM CIFS配置，似乎也没有问题。</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>MyFileCluster::&gt; vserver  show -vserver svm_cifs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>翻遍ManageEngine ADAudit Plus的官方支持手册和Google也没有解决方案。</p><div class="hint-container tip"><p class="hint-container-title">题外：什么是ONTAP VServer/SVM</p><p>Storage Virtual Machine（SVM，以前称为 Vserver） ONTAP SVM 对于客户端而言都是一个专用CIFS/NFS服务器，简单理解SVM就是运行在ONTAP里面的一台虚拟机，对外提供CIFS/NFS协议。</p></div><p>** 解决方案和特殊配置**</p><p>SVM计算机对象明明已经在AD里面存在了，为什么会搜索不到？</p><p>分析，ADAudit应该是通过一些特定AD属性来发现和判断计算机对象是否是NetAPP ONTAP。翻看这个SVM AD计算机属性，分析比较有可能就是AD计算机属性的<code>operatingSystem</code>，如下图：</p><figure><img src="`+n+'" alt="Before" tabindex="0" loading="lazy"><figcaption>Before</figcaption></figure><p>以上图，凌拓默认使用的是<code>Lenovo Release 9.11.1P4</code>, 尝试修改成<code>Ontap</code>,如下图：</p><figure><img src="'+s+'" alt="After" tabindex="0" loading="lazy"><figcaption>After</figcaption></figure><p>等待几分钟，然后通过ADAudit配置NetApp服务器向导，可以发现到了! 😃</p><p>发现后，根据文档配置NAS集群和启动文件审计选项即可。</p><p><strong>一些SVM配置审计参考</strong></p>',36),r=[d];function o(c,u){return i(),t("div",null,r)}const v=e(l,[["render",o],["__file","post55_sec_file_auditing_01.html.vue"]]);export{v as default};
