import{_ as e,W as a,X as t,Y as r}from"./framework-2e6688e7.js";const i={},d=r(`<h2 id="问题描述" tabindex="-1"><a class="header-anchor" href="#问题描述" aria-hidden="true">#</a> 问题描述</h2><ul><li>在admin console GUI里，当前配置Storage服务求或操作AIR或添加信任Master服务器，当Netbackup备份域内或跨域之间获取Master证书失败；</li><li>在shell下，使用<code>nbcertcmd -getCertificate</code>获取master服务器失败。提示错误<code>8504</code>,因为CA证书不信任。</li></ul><h2 id="问题分析" tabindex="-1"><a class="header-anchor" href="#问题分析" aria-hidden="true">#</a> 问题分析</h2><p>媒体服务器（Storage Server)不信任Master服务器CA证书。</p><h2 id="解决办法" tabindex="-1"><a class="header-anchor" href="#解决办法" aria-hidden="true">#</a> 解决办法</h2><blockquote><p>手动部署证书。通过nbcertcmd离线申请证书, 然后发到目标域的Master上颁发。</p></blockquote><h3 id="步骤" tabindex="-1"><a class="header-anchor" href="#步骤" aria-hidden="true">#</a> 步骤</h3><ul><li><p>在Master准备一个证书token或是使用已有的token。</p></li><li><p>在media 上创建证书申请，执行：</p></li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>/usr/openv/netbackup/bin/admincmd/nbcertcmd -createCertRequest -RequestFile mymediaserver.csr -server &lt;target_master_server&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>在目标域的master上签发证书，执行：</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Nbcertcmd -signCertificate -RequestFile mymediaserver.csr -CertificateFile mycert.crt -token &lt;目标域Master发放的token ID&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>在media上部署证书，执行：</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Nbcertcmd -deployCertificate  -CertificateFile mycert.crt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,13),c=[d];function s(l,n){return a(),t("div",null,c)}const u=e(i,[["render",s],["__file","post38_backup_nbu_02.html.vue"]]);export{u as default};
