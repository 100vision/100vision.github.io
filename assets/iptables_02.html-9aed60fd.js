import{_ as a,W as e,X as s,Y as n}from"./framework-b5535326.js";const i={},l=n(`<h2 id="iptables的常用命令" tabindex="-1"><a class="header-anchor" href="#iptables的常用命令" aria-hidden="true">#</a> iptables的常用命令</h2><h3 id="查看规则。" tabindex="-1"><a class="header-anchor" href="#查看规则。" aria-hidden="true">#</a> 查看规则。</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>iptables <span class="token parameter variable">-L</span> <span class="token parameter variable">-t</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span> <span class="token parameter variable">-v</span> --line-numbers
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>表名有: nat,filter,mangle</li></ul><p><strong>举例:查看nat表中的规则</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>iptables <span class="token parameter variable">-L</span> <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-v</span> --line-numbers
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>输出类似：</p><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>
Chain POSTROUTING (policy ACCEPT 285 packets, 37567 bytes)
num   pkts bytes target     prot opt in     out     source               destination
1        0     0 MASQUERADE  all  --  any    !docker0  172.17.0.0/16        anywhere
2        0     0 MASQUERADE  all  --  any    !br-2810b48c01b9  172.18.0.0/16        anywhere
3        0     0 MASQUERADE  tcp  --  any    any     172.18.0.4           172.18.0.4           tcp dpt:http
4        0     0 MASQUERADE  tcp  --  any    any     172.18.0.5           172.18.0.5           tcp dpt:mysql
5        4   240 MASQUERADE  all  --  any    eth0    192.0.2.0/24         anywhere
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="添加规则" tabindex="-1"><a class="header-anchor" href="#添加规则" aria-hidden="true">#</a> 添加规则</h3><p>2.1 指定链和表添加规则</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>iptables <span class="token parameter variable">-t</span> <span class="token operator">&lt;</span>表名<span class="token operator">&gt;</span> <span class="token parameter variable">-A</span> <span class="token operator">&lt;</span>链名<span class="token operator">&gt;</span> <span class="token parameter variable">-d</span> <span class="token operator">&lt;</span>目标网络/主机<span class="token operator">&gt;</span> <span class="token parameter variable">-s</span> <span class="token operator">&lt;</span>源<span class="token operator">&gt;</span> <span class="token parameter variable">-j</span> <span class="token operator">&lt;</span>动作<span class="token operator">&gt;</span> <span class="token parameter variable">-i</span> <span class="token operator">&lt;</span>网络接口名<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>举例：添加POSTROUTING链的1条规则实现源地址转换</strong>：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -i eth0 -j MASQUERADE
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="删除规则" tabindex="-1"><a class="header-anchor" href="#删除规则" aria-hidden="true">#</a> 删除规则</h3><div class="hint-container tip"><p class="hint-container-title">定位规则编号</p><p>iptables -L --line-nubmers</p></div><ul><li>3.1 指定链，规则号删除</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>iptables <span class="token parameter variable">-D</span> <span class="token operator">&lt;</span>链名<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>n<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>举例：删除POSTROUTING链的1号规则</strong>：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>iptables <span class="token parameter variable">-D</span> POSTROUTING <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>3.2 清空和删除所有规则</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>iptables <span class="token parameter variable">-F</span>
iptables-save
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="保存规则" tabindex="-1"><a class="header-anchor" href="#保存规则" aria-hidden="true">#</a> 保存规则</h3><p>默认iptables规则保存在内存里，系统重启后消失。所以要记得保存到文件。</p><ul><li>如果使用了iptables.service来管理，CentOS下执行<code>/sbin/iptables-save</code>来保存到<code>/etc/sysconfig/iptables</code>，系统重启后会从该文件加载规则配置。</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>iptables-save 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>如果没有使用iptable.service来管理规则配置(使用命令/sbin/iptables等)，管理员需要手动调用<code>/sbin/iptables-save</code>保存到文件，然后再使用<code> /sbin/iptables-restore</code>手动加载。</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>/sbin/iptables-save <span class="token operator">&gt;</span> /etc/sysconfig/iptables
/sbin/iptables-restore  <span class="token operator">&lt;</span> /etc/sysconfig/iptables
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="未完待续" tabindex="-1"><a class="header-anchor" href="#未完待续" aria-hidden="true">#</a> （未完待续）</h2>`,28),t=[l];function r(d,p){return e(),s("div",null,t)}const o=a(i,[["render",r],["__file","iptables_02.html.vue"]]);export{o as default};
