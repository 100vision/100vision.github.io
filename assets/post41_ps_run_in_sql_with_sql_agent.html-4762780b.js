const e=JSON.parse(`{"key":"v-adf585c0","path":"/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/%E7%BC%96%E7%A8%8B/post41_ps_run_in_sql_with_sql_agent.html","title":"脚本编程：Powershell：在SQL Server的SQL Agent里执行Powershell脚本","lang":"zh-CN","frontmatter":{"title":"脚本编程：Powershell：在SQL Server的SQL Agent里执行Powershell脚本","icon":"page","order":41,"date":"2023-06-26T00:00:00.000Z","category":["Scripting Language","脚本编程","Powershell"],"tag":["Powershell","SQLServer"],"sticky":false,"star":true,"description":"背景 有个需求就是：在没有SQL Server服务器操作系统账户、只有数据库账户sa情况下，把远程SQL服务器上的某个文件上传到sftp服务器。前面尝试使用存储过程xp_cmdshell执行Powershell脚本来完成，但没有成功，没成功的原因可能是脚本内容有一下特殊字符，包裹在xp_cmdshell的cmd_string里转义失败。后来 发现通过SQL Agent的job作业也可以执行Powershell脚本，而且更方便强大，可以计划调度运行。","head":[["meta",{"property":"og:url","content":"https://blog.solex-inc.com/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/%E7%BC%96%E7%A8%8B/post41_ps_run_in_sql_with_sql_agent.html"}],["meta",{"property":"og:site_name","content":"Tim's Blog"}],["meta",{"property":"og:title","content":"脚本编程：Powershell：在SQL Server的SQL Agent里执行Powershell脚本"}],["meta",{"property":"og:description","content":"背景 有个需求就是：在没有SQL Server服务器操作系统账户、只有数据库账户sa情况下，把远程SQL服务器上的某个文件上传到sftp服务器。前面尝试使用存储过程xp_cmdshell执行Powershell脚本来完成，但没有成功，没成功的原因可能是脚本内容有一下特殊字符，包裹在xp_cmdshell的cmd_string里转义失败。后来 发现通过SQL Agent的job作业也可以执行Powershell脚本，而且更方便强大，可以计划调度运行。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-06-26T07:37:02.000Z"}],["meta",{"property":"article:tag","content":"Powershell"}],["meta",{"property":"article:tag","content":"SQLServer"}],["meta",{"property":"article:published_time","content":"2023-06-26T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-06-26T07:37:02.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"脚本编程：Powershell：在SQL Server的SQL Agent里执行Powershell脚本\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-06-26T00:00:00.000Z\\",\\"dateModified\\":\\"2023-06-26T07:37:02.000Z\\",\\"author\\":[]}"]]},"headers":[{"level":2,"title":"SQL Server Agent介绍","slug":"sql-server-agent介绍","link":"#sql-server-agent介绍","children":[]},{"level":2,"title":"使用SQL Server Agent执行Powershell脚本","slug":"使用sql-server-agent执行powershell脚本","link":"#使用sql-server-agent执行powershell脚本","children":[]},{"level":2,"title":"Side Notes : 关于文件上传脚本","slug":"side-notes-关于文件上传脚本","link":"#side-notes-关于文件上传脚本","children":[]}],"git":{"createdTime":1687764548000,"updatedTime":1687765022000,"contributors":[{"name":"100vision","email":"lin.tixiang@gmail.com","commits":2}]},"readingTime":{"minutes":2.88,"words":864},"filePathRelative":"zh/信息技术/编程/post41_ps_run_in_sql_with_sql_agent.md","localizedDate":"2023年6月26日","excerpt":"<div class=\\"hint-container tip\\">\\n<p class=\\"hint-container-title\\">背景</p>\\n<p>有个需求就是：在没有SQL Server服务器操作系统账户、只有数据库账户sa情况下，把远程SQL服务器上的某个文件上传到sftp服务器。前面尝试使用存储过程<code>xp_cmdshell</code>执行Powershell脚本来完成，但没有成功，没成功的原因可能是脚本内容有一下特殊字符，包裹在xp_cmdshell的<code>cmd_string</code>里转义失败。后来 发现通过<code>SQL Agent</code>的job作业也可以执行Powershell脚本，而且更方便强大，可以计划调度运行。</p>\\n</div>","autoDesc":true}`);export{e as data};
