import{_ as l,W as n,X as a,Z as e,$ as o,a0 as d,Y as t,G as r}from"./framework-2e6688e7.js";const s={},c=t(`<h2 id="需求和背景" tabindex="-1"><a class="header-anchor" href="#需求和背景" aria-hidden="true">#</a> 需求和背景</h2><p>解决一些需求：</p><ul><li>用户计算机没法访问Google官方商店，使用本地自建商店解决；</li><li>推送自开发的扩展（需要本地自建商店）；</li><li>管理员推送必安装的扩展（可以官方，也可以本地自建商店；</li></ul><div class="hint-container tip"><p class="hint-container-title">推送工具</p><p>如果有AD域环境，一般使用组策略推送下去。策略模板可以在Google有企业版Chrome Enterprise Bundle找到。模板文件上传到域控的PolicyDefinitions。</p></div><h2 id="如果推送官方商店的扩展" tabindex="-1"><a class="header-anchor" href="#如果推送官方商店的扩展" aria-hidden="true">#</a> 如果推送官方商店的扩展</h2><p>比较简单。但前提是，用户电脑可以科学上网。</p><ul><li>在Chrome Web商店里，找到要推送的扩展，并记下它的<code>Extension Id</code>。等下会用到；</li><li>新建一条组策略；编辑策略找到<code>Computer Configuration/Administrative Templates/Google/Extensions/Configure the list of force-installed apps and extensions</code></li><li>填入上面记下的<strong>Extension Id</strong>。</li><li>完。下次用户的Chrome就会自动安装该扩展；</li></ul><h2 id="如果推送本地自己的扩展" tabindex="-1"><a class="header-anchor" href="#如果推送本地自己的扩展" aria-hidden="true">#</a> 如果推送本地自己的扩展</h2><p>麻烦一点，有3个任务：</p><ul><li>搭建本地商店；</li><li>打包自己的扩展（需要源码）；</li><li>推送扩展；</li></ul><h3 id="搭建本地商店" tabindex="-1"><a class="header-anchor" href="#搭建本地商店" aria-hidden="true">#</a> 搭建本地商店</h3><p>搭建本地商店就是需要一个简单的Web服务器。IIS/Apache等都可以。</p><div class="hint-container note"><p class="hint-container-title">注意</p><ol><li>要允许匿名访问，不做认证；2. 需要设置和添加一个文件扩展名.crx的 <code>application/x-chrome-extension</code> （Chrome据此判断crx文件是否可以可以安装）</li></ol></div><p>以IIS为例，步骤：</p><ul><li>新建一个目录，例如MyStore。设置目录ACL,添加<code>IIS_USR</code>，可读可执行；</li><li>新建一个IIS站点，指定一个未使用的端口；主目录指向新建的目录 MyStore;</li><li>添加一个MIME类型。文件扩展名输入<code>.crx</code> , MIME类型填入 <code>application/x-chrome-extension</code></li><li>完成；</li></ul><h3 id="打包扩展" tabindex="-1"><a class="header-anchor" href="#打包扩展" aria-hidden="true">#</a> 打包扩展</h3><ul><li>准备好扩展的源码；</li><li>打开Chrome，打开【扩展】，右上角，选中【开发者模式】；</li><li>点击【加载已解压的扩展程序】载入；根据需求配置扩展选项，验证扩展工作正常；</li><li>点击【打包扩展程序】，指向源码文件夹，输出打包好的扩展, 默认是<code>&lt;源码文件夹名&gt;.crx</code>；</li><li>把打包好的crx文件，直接拖入到扩展程序窗口安装。安装好的扩展默认是禁用的，不可以使用，可以不理会。记下它的ID，32位，例如obpdhkhgjdcobgnomfhokfnlaofbcpcg。然后移除这个禁用的扩展，不需要了。</li><li>使用以上ID重命名crx文件，例如obpdhkhgjdcobgnomfhokfnlaofbcpcg.crx</li></ul><h3 id="准备推送扩展" tabindex="-1"><a class="header-anchor" href="#准备推送扩展" aria-hidden="true">#</a> 准备推送扩展</h3><ul><li>把 obpdhkhgjdcobgnomfhokfnlaofbcpcg.crx 拷贝到前面准备好的本地商店的MyStore目录下；</li><li>验证文件是否可以下载。使用浏览器打开下载url，我的例子就是：</li></ul><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>http://example.com:8080/mystore/obpdhkhgjdcobgnomfhokfnlaofbcpcg.crx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>如果没有弹窗认证，直接下载窗口就可以了；</li><li>编写扩展安装的manifest XML文件,取名update.xml。样本如下：</li></ul><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;
&lt;gupdate xmlns=&#39;http://www.google.com/update2/response&#39; protocol=&#39;2.0&#39;&gt;
  &lt;app appid=&#39;obpdhkhgjdcobgnomfhokfnlaofbcpcg
&#39;&gt;
    &lt;updatecheck codebase=&#39;https://example.com/mystore/obpdhkhgjdcobgnomfhokfnlaofbcpcg.crx&#39; version=&#39;1.0&#39; /&gt;
  &lt;/app&gt;
&lt;/gupdate&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>把<code>update.xml</code>拷贝到扩展文件同一目录并测试它的url；</li><li>记下update.xml的url；</li></ul><h3 id="开始推送扩展" tabindex="-1"><a class="header-anchor" href="#开始推送扩展" aria-hidden="true">#</a> 开始推送扩展</h3><p>开始之前，确保以下都有：</p><ul><li>Extension ID 就绪；</li><li>manifest XML的下载url就绪；</li></ul><p><strong>开始</strong></p><ul><li><p>新建一条组策略；编辑策略找到<code>Computer Configuration/Administrative Templates/Google/Extensions/Configure the list of force-installed apps and extensions</code></p></li><li><p>填入上面记下的<strong>Extension Id</strong> 和manifest XML的url,它们之间使用英文分号分开，例如：</p></li></ul><div class="language-plain line-numbers-mode" data-ext="plain"><pre class="language-plain"><code>obpdhkhgjdcobgnomfhokfnlaofbcpcg;http://example.com/mystore/update.xml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>测试。链接策略到一个测试计算机对象OU。</li></ul><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考" aria-hidden="true">#</a> 参考</h2>`,31),p={href:"https://docs.google.com/document/d/1pT0ZSbGdrbGvuCsVD2jjxrw-GVz-80rMS2dgkkquhTY/edit#",target:"_blank",rel:"noopener noreferrer"};function h(u,m){const i=r("ExternalLinkIcon");return n(),a("div",null,[c,e("p",null,[e("a",p,[o("Google Enterprise: Hosting your extension"),d(i)])])])}const x=l(s,[["render",h],["__file","chrome_extension_push_install.html.vue"]]);export{x as default};
