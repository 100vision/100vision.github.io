import{_ as e,W as t,X as o,Y as i}from"./framework-b5535326.js";const n="/assets/post18_sccm_policy_id_exmaple-2344ccdd.png",a={},l=i('<h2 id="purpose" tabindex="-1"><a class="header-anchor" href="#purpose" aria-hidden="true">#</a> Purpose</h2><p>See SCCM deployment task is not completed and worked as unexpected. As a result, app/package/compliance baseline was not executed and installed. need to find out</p><ul><li>why my deployment went wrong.</li><li>in what phrase the deployment get stuck</li></ul><p>so in this post, I wanted to demonstrate myself how to track down a deployment process and what to look into when starting a troubelshooting.</p><h3 id="sccm-logging" tabindex="-1"><a class="header-anchor" href="#sccm-logging" aria-hidden="true">#</a> SCCM Logging</h3><p>SCCM offers a bunch of very useful log files on CCM client side for admin to track how the policy is executed. Locate these log files on client side <code>c:\\windows\\ccm\\logs</code>.</p><h3 id="policy-id" tabindex="-1"><a class="header-anchor" href="#policy-id" aria-hidden="true">#</a> Policy ID</h3><p>Before we start following through a deployment process ,first thing is to find out the policy ID which is the very important piece of info we needed to start the troubleshooting journey.</p><p>Generally, a deployment from SCCM server is treated by CCM client as a policy so policyId is the deploymenId, they are the one and same . Follow the steps below to find out the policy ID:</p><ul><li>Open up SCCM admin console in `debugView&#39; mode. Otherwise, PolicyID wouldn&#39;t be shown up.</li></ul><div class="language-cmd line-numbers-mode" data-ext="cmd"><pre class="language-cmd"><code>&quot;C:\\Program Files (x86)\\Microsoft Configuration Manager\\AdminConsole\\bin\\Microsoft.ConfigurationManagement.exe&quot; sms:debugview\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>Go to <code>Monitoring</code></li><li>Locate the deployment task you want to track down;</li><li>Right click the deployment and click <code>show object details</code></li><li>DeploymentID could be seen in a list of <code>Properties</code> fileds. in this demo, the deploymentID/PolicyID is <code>{5E7EC5C2-DE88-46BE-89CB-0341B7932B78}</code> as illustrated below.</li></ul><figure><img src="'+n+`" alt="policy_id" tabindex="0" loading="lazy"><figcaption>policy_id</figcaption></figure><h3 id="policyagent-log" tabindex="-1"><a class="header-anchor" href="#policyagent-log" aria-hidden="true">#</a> PolicyAgent.log</h3><blockquote><p>Once we have the policyID, let&#39;s start with <code>policyAgent.log</code> becasue it is first stop that our policy shoud come in.</p></blockquote><ul><li>in this demo, the policy <code>{5E7EC5C2-DE88-46BE-89CB-0341B7932B78}</code> is being downloaded by DTS (DataTransferService) and assined to DTS download job id <code>{B45955B6-1902-4FCA-93BD-921DB7B317DC}</code></li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[Download of policy CCM_Policy_Policy5.PolicyID=&quot;{5E7EC5C2-DE88-46BE-89CB-0341B7932B78}&quot;,PolicySource=&quot;SMS:002&quot;,PolicyVersion=&quot;1.00&quot; completed (DTS Job ID: {B45955B6-1902-4FCA-93BD-921DB7B317DC})]LOG]!&gt;&lt;time=&quot;15:30:15.759-480&quot; date=&quot;05-09-2023&quot; component=&quot;PolicyAgent_PolicyDownload&quot; context=&quot;&quot; type=&quot;1&quot; thread=&quot;4088&quot; file=&quot;policydownloadendpoint.cpp:608&quot;&gt;
&lt;![LOG[Raising event:

instance of CCM_PolicyAgent_PolicyDownloadSucceeded
{
	ClientID = &quot;GUID:9EC29837-CBA8-48B7-AFC1-78BBD2F456DE&quot;;
	DateTime = &quot;20230509073015.769000+000&quot;;
	DownloadMethod = &quot;BITS&quot;;
	DownloadSource = &quot;http://XMPRITSCCM01.example-server.com/SMS_MP/.sms_pol?{5E7EC5C2-DE88-46BE-89CB-0341B7932B78}.SHA256:1D9B44CB35C72CBE30FD27A2CF753814E418BB217120E60E841904430090DF97&quot;;
	PolicyNamespace = &quot;\\\\\\\\.\\\\ROOT\\\\CCM\\\\Policy\\\\Machine\\\\RequestedConfig&quot;;
	PolicyPath = &quot;CCM_Policy_Policy5.PolicyID=\\&quot;{5E7EC5C2-DE88-46BE-89CB-0341B7932B78}\\&quot;,PolicySource=\\&quot;SMS:002\\&quot;,PolicyVersion=\\&quot;1.00\\&quot;&quot;;
	ProcessID = 5436;
	ThreadID = 4088;
};
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="datatransferservice-log" tabindex="-1"><a class="header-anchor" href="#datatransferservice-log" aria-hidden="true">#</a> DataTransferService.log</h3><blockquote><p>here to check how the download goes</p></blockquote><p>our job id was {B45955B6-1902-4FCA-93BD-921DB7B317DC} which is completed with no error.</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;![LOG[DTSJob {B45955B6-1902-4FCA-93BD-921DB7B317DC} created to download from &#39;http://XMPRITSCCM01.example-server.com:80/SMS_MP&#39; to &#39;C:\\Windows\\CCM\\Temp&#39;.]LOG]!&gt;&lt;time=&quot;15:30:09.905-480&quot; date=&quot;05-09-2023&quot; component=&quot;DataTransferService&quot; context=&quot;&quot; type=&quot;1&quot; thread=&quot;4352&quot; file=&quot;datatransferservice.cpp:330&quot;&gt;
（略）
&lt;![LOG[DTSJob {71EF16C0-CF7B-4209-AAC7-266900265D9D} successfully completed download.]LOG]!&gt;&lt;time=&quot;15:30:11.295-480&quot; date=&quot;05-09-2023&quot; component=&quot;DataTransferService&quot; context=&quot;&quot; type=&quot;1&quot; thread=&quot;3608&quot; file=&quot;dtsjob.cpp:4010&quot;&gt;
&lt;![LOG[DTSJob {71EF16C0-CF7B-4209-AAC7-266900265D9D} in state &#39;NotifiedComplete&#39;.]LOG]!&gt;&lt;time=&quot;15:30:11.311-480&quot; date=&quot;05-09-2023&quot; component=&quot;DataTransferService&quot; context=&quot;&quot; type=&quot;1&quot; thread=&quot;7840&quot; file=&quot;DTSJob.h:180&quot;&gt;
&lt;![LOG[DTS job {71EF16C0-CF7B-4209-AAC7-266900265D9D} has completed:
	Status : SUCCESS,
	Start time : 05/09/2023 15:30:09,
	Completion time : 05/09/2023 15:30:11,
	Elapsed time : 1 seconds]LOG]!&gt;&lt;time=&quot;15:30:11.313-480&quot; date=&quot;05-09-2023&quot; component=&quot;DataTransferService&quot; context=&quot;&quot; type=&quot;1&quot; thread=&quot;7840&quot; file=&quot;util.cpp:3436&quot;&gt;

&lt;![LOG[DTS job {B45955B6-1902-4FCA-93BD-921DB7B317DC} has completed:

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="policyevaluator-log" tabindex="-1"><a class="header-anchor" href="#policyevaluator-log" aria-hidden="true">#</a> policyEvaluator.log</h3><blockquote><p>here to check how the policy is being evaulated and complied and applied.</p></blockquote><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>]LOG]!&gt;&lt;time=&quot;15:30:15.885-480&quot; date=&quot;05-09-2023&quot; component=&quot;PolicyAgent_PolicyEvaluator&quot; context=&quot;&quot; type=&quot;1&quot; thread=&quot;4088&quot; file=&quot;Event.cpp:840&quot;&gt;
&lt;![LOG[Applied policy CCM_Policy_Policy5.PolicyID=&quot;{5E7EC5C2-DE88-46BE-89CB-0341B7932B78}&quot;,PolicySource=&quot;SMS:002&quot;,PolicyVersion=&quot;1.00&quot;]LOG]!&gt;&lt;time=&quot;15:30:15.890-480&quot; date=&quot;05-09-2023&quot; component=&quot;PolicyAgent_PolicyEvaluator&quot; context=&quot;&quot; type=&quot;1&quot; thread=&quot;4088&quot; file=&quot;policyutil.cpp:9196&quot;&gt;

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>if sucessful, the policy is being appled.</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;![LOG[Applying policy {5E7EC5C2-DE88-46BE-89CB-0341B7932B78}]LOG]!&gt;&lt;time=&quot;15:30:15.845-480&quot; date=&quot;05-09-2023&quot; component=&quot;PolicyAgent_PolicyEvaluator&quot; context=&quot;&quot; type=&quot;1&quot; thread=&quot;4088&quot; file=&quot;policyutil.cpp:6357&quot;&gt;
&lt;![LOG[Updating policy CCM_Policy_Policy5.PolicyID=&quot;{e5829a2d-64c1-48fc-be23-69d1c5ea810d}&quot;,PolicySource=&quot;SMS:002&quot;,PolicyVersion=&quot;9.00&quot;]LOG]!&gt;&lt;time=&quot;15:30:15.856-480&quot; date=&quot;05-09-2023&quot; component=&quot;PolicyAgent_PolicyEvaluator&quot; context=&quot;&quot; type=&quot;1&quot; thread=&quot;9116&quot; file=&quot;policyutil.cpp:9115&quot;&gt;
&lt;![LOG[Raising event:

instance of CCM_PolicyAgent_PolicyRuleApplied
{
	ClientID = &quot;GUID:9EC29837-CBA8-48B7-AFC1-78BBD2F456DE&quot;;
	DateTime = &quot;20230509073015.884000+000&quot;;
	PolicyID = &quot;{5E7EC5C2-DE88-46BE-89CB-0341B7932B78}&quot;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="final-stop" tabindex="-1"><a class="header-anchor" href="#final-stop" aria-hidden="true">#</a> Final Stop</h3><ul><li>Final #Destination 1: Execmgr.log (Package Deployment)</li><li>Final #Destination 2: AppEnforce.log (Application Deployment)</li><li>Final #Destination 3: DCMAgent.log /CIAgent.log (Compliance Baseline Deployment)</li></ul><p><strong>Final stop to check for admin vary depending on the deployment types listed above.</strong> in this demo, it is <code>Compliance Baseline Deployment</code></p><h3 id="dcmagent-log" tabindex="-1"><a class="header-anchor" href="#dcmagent-log" aria-hidden="true">#</a> DCMAgent.log</h3><p>For compliance evaluation policy, finally, policy is being assigned into a DCM job <code>{4A02F07C-F786-4EDD-9674-CA4B6893FD16}</code>)by DCM Agent</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;![LOG[DCMAgentJob({4A02F07C-F786-4EDD-9674-CA4B6893FD16}): CDCMAgentJob::SetupJob - Add assignment _example_DingTalk_Removal_SCCM Client Present({5E7EC5C2-DE88-46BE-89CB-0341B7932B78})]LOG]!&gt;&lt;time=&quot;08:22:49.152-480&quot; date=&quot;05-10-2023&quot; component=&quot;DCMAgent&quot; context=&quot;&quot; type=&quot;1&quot; thread=&quot;8676&quot; file=&quot;dcmagentjob.cpp:3251&quot;&gt;

&lt;![LOG[DCMAgentJob({4A02F07C-F786-4EDD-9674-CA4B6893FD16}): CDCMAgentJob::PopulateCIsFromAssignment - [SCAN] CI policy Id :ScopeId_46E06C1F-1234-4969-A016-8C1CFC11DAB5/Baseline_e8da6249-e3ae-4f6e-a154-0aa1c96931c2 version:1 - Assignment:{5E7EC5C2-DE88-46BE-89CB-0341B7932B78} is not mandatory.]LOG]!&gt;&lt;time=&quot;08:22:49.177-480&quot; date=&quot;05-10-2023&quot; component=&quot;DCMAgent&quot; context=&quot;&quot; type=&quot;1&quot; thread=&quot;8676&quot; file=&quot;dcmagentjob.cpp:3251&quot;&gt;
&lt;![LOG[CDCMAgentJobMgr::StartJob - Starting DCM Agent job {4A02F07C-F786-4EDD-9674-CA4B6893FD16}]LOG]!&gt;&lt;time=&quot;08:22:49.180-480&quot; date=&quot;05-10-2023&quot; component=&quot;DCMAgent&quot; context=&quot;&quot; type=&quot;1&quot; thread=&quot;8676&quot; file=&quot;dcmagentjobmgr.cpp:444&quot;&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>DCMAgent started a CI job CI Agent Job <code>{F2C3175D-A639-4993-83E3-70E9F07C18D7}</code></li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;![LOG[DCMAgentJob({4A02F07C-F786-4EDD-9674-CA4B6893FD16}): CDCMAgent::InitiateCIAgentJob - Starting CI Agent Job {F2C3175D-A639-4993-83E3-70E9F07C18D7} for target: machine. Refer to this CI agent job ID in ciagent.log for more details]LOG]!&gt;&lt;time=&quot;08:22:49.210-480&quot; date=&quot;05-10-2023&quot; component=&quot;DCMAgent&quot; context=&quot;&quot; type=&quot;1&quot; thread=&quot;8068&quot; file=&quot;dcmagentjob.cpp:3251&quot;&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="ciagent-log" tabindex="-1"><a class="header-anchor" href="#ciagent-log" aria-hidden="true">#</a> CIAgent.log</h3><p>here to check CI job details. Our Compliance Evaluatiion is being evaluated on client</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>&lt;![LOG[CIAgentJob({F2C3175D-A639-4993-83E3-70E9F07C18D7}):  CI ScopeId_46E06C1F-1234-4969-A016-8C1CFC11DAB5/Baseline_e8da6249-e3ae-4f6e-a154-0aa1c96931c2:1 (_example_DingTalk_Removal) targeted to  (Dependant of policy CI ScopeId_46E06C1F-1234-4969-A016-8C1CFC11DAB5/Baseline_e8da6249-e3ae-4f6e-a154-0aa1c96931c2:1) is in scope for evaluation.]LOG]!&gt;&lt;time=&quot;08:22:52.435-480&quot; date=&quot;05-10-2023&quot; component=&quot;CIAgent&quot; context=&quot;&quot; type=&quot;1&quot; thread=&quot;8676&quot; file=&quot;agentjob.cpp:3284&quot;&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="that-s-it-journey-is-over" tabindex="-1"><a class="header-anchor" href="#that-s-it-journey-is-over" aria-hidden="true">#</a> that&#39;s it. Journey is over.</h3>`,38),u=[l];function d(c,s){return t(),o("div",null,u)}const q=e(a,[["render",d],["__file","win_sccm_troubleshooting_1.html.vue"]]);export{q as default};
