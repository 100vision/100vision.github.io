import{_ as l,W as a,X as c,Z as e,$ as n,a0 as t,a1 as i,Y as s,G as r}from"./framework-b5535326.js";const h={},p=e("h2",{id:"前言",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#前言","aria-hidden":"true"},"#"),n(" 前言")],-1),u=e("p",null,"国内环境下，除了不能直连海外服务器问题外，还有DNS污染问题让人恼火，因此需要了解一下怎么解决。 另外吐槽一下，在本朝很多东西都是zz的延申。",-1),_=e("h2",{id:"什么是dns污染",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#什么是dns污染","aria-hidden":"true"},"#"),n(" 什么是DNS污染")],-1),D={href:"https://zh.wikipedia.org/zh-cn/%E5%9F%9F%E5%90%8D%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%93%E5%AD%98%E6%B1%A1%E6%9F%93",target:"_blank",rel:"noopener noreferrer"},N=s('<h2 id="怎么解决" tabindex="-1"><a class="header-anchor" href="#怎么解决" aria-hidden="true">#</a> 怎么解决</h2><p>实现原理：普通DNS流量因为都是明文，没有加密才会被导致篡改，给DNS流量加密，套一层解决。加密方法主要有这么几种。</p><ul><li>DOH (DNS Over HTTPS)</li><li>DOT (DNS Over TLS)</li><li>DNS Encrypt</li></ul><p>具体方法是：</p><ul><li>在本地部署一台DNS缓存服务器，和上游DNS服务器通讯加密。实现方法可以是DOH或是DNS Encrypt</li><li>本地其他主机的DNS服务器指向到本地DNS缓存服务器。</li></ul><h2 id="方案选项1-使用doh部署本地dns缓存服务器" tabindex="-1"><a class="header-anchor" href="#方案选项1-使用doh部署本地dns缓存服务器" aria-hidden="true">#</a> 方案选项1：使用DOH部署本地DNS缓存服务器</h2><h3 id="步骤1-选择doh服务器作为上游dns服务器" tabindex="-1"><a class="header-anchor" href="#步骤1-选择doh服务器作为上游dns服务器" aria-hidden="true">#</a> 步骤1：选择DOH服务器作为上游DNS服务器</h3><p>当前使用比较多的是DOH，比较著名的支持DOH的公网DNS服务器有：</p><ul><li>Cloudflare的<code>1.1.1.1</code></li><li>Google的 <code>8.8.8.8</code></li></ul>',9),S={href:"https://github.com/dnscrypt/dnscrypt-resolvers",target:"_blank",rel:"noopener noreferrer"},f=e("h3",{id:"步骤2-部署本地dns缓存服务器",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#步骤2-部署本地dns缓存服务器","aria-hidden":"true"},"#"),n(" 步骤2：部署本地DNS缓存服务器")],-1),m=e("p",null,"本地DNS缓存服务器，它扮演DOH客户端，负责转发本地的DNS查询给外部的DOH服务器，需要本地部署。 可以使用支持DOH的客户端软件部署本地DNS缓存服务器。比较著名支持DOH的DNS客户端软件有：",-1),E=e("ul",null,[e("li",null,[e("code",null,"dnsmasq")]),e("li",null,[e("code",null,"dnscrypt-proxy")])],-1),b=e("p",null,[e("strong",null,"开始部署")],-1),x=e("p",null,"搭建步骤可以参考：",-1),y={href:"https://page.codespaper.com/2019/dnsmasq-cloudflare-doh/",target:"_blank",rel:"noopener noreferrer"},k=s('<h3 id="步骤3-使用本地缓存服务器dnsmasq" tabindex="-1"><a class="header-anchor" href="#步骤3-使用本地缓存服务器dnsmasq" aria-hidden="true">#</a> 步骤3：使用本地缓存服务器dnsmasq</h3><ul><li>如果是dnsmasq和本机一台主机使用，可以修改<code>/etc/resolv.conf</code>。删除所有<code>nameserver</code>，添加一行<code>nameserver 127.0.0.1</code> 即可。</li><li>如果是供内网所有主机使用，修改内网主机的DNS服务器指向到dnsmasq。</li></ul><h2 id="方案选项2-使用dns-encrypt" tabindex="-1"><a class="header-anchor" href="#方案选项2-使用dns-encrypt" aria-hidden="true">#</a> 方案选项2：使用DNS Encrypt</h2>',3),g={href:"https://github.com/DNSCrypt/dnscrypt-proxy",target:"_blank",rel:"noopener noreferrer"};function v(H,O){const o=r("ExternalLinkIcon"),d=r("RouterLink");return a(),c("div",null,[p,u,_,e("blockquote",null,[e("p",null,[n("又称DNS“投毒”,执行DNS劫持攻击导致下游DNS服务器缓存了错误记录的现象。详见"),e("a",D,[n("wiki"),t(o)])])]),N,e("blockquote",null,[e("p",null,[n("更多可以查询这里 "),e("a",S,[n("https://github.com/dnscrypt/dnscrypt-resolvers"),t(o)])])]),f,m,E,b,x,e("ul",null,[e("li",null,[e("a",y,[n("dnsmasq + Cloudflare DoH 自建 DNS"),t(o)])]),e("li",null,[t(d,{to:"/zh/%E4%BF%A1%E6%81%AF%E6%8A%80%E6%9C%AF/%E7%BD%91%E7%BB%9C/shttps:/developers.cloudflare.com/1.1.1.1/encryption/dns-over-https/dns-over-https-client/"},{default:i(()=>[n("Connect to 1.1.1.1 using DoH client")]),_:1})])]),k,e("p",null,[n("可以参考 "),e("a",g,[n("https://github.com/DNSCrypt/dnscrypt-proxy"),t(o)])])])}const q=l(h,[["render",v],["__file","post46_dns_solutions.html.vue"]]);export{q as default};
