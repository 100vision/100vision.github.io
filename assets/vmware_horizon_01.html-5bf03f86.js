import{_ as r,W as a,X as s,Z as i,$ as o,a0 as n,Y as e,G as t}from"./framework-2e6688e7.js";const h={},p=e('<h1 id="一、配置管理解决方案-microsoft-fslogix" tabindex="-1"><a class="header-anchor" href="#一、配置管理解决方案-microsoft-fslogix" aria-hidden="true">#</a> 一、配置管理解决方案 Microsoft FSLogix</h1><h2 id="_1、什么是fslogix" tabindex="-1"><a class="header-anchor" href="#_1、什么是fslogix" aria-hidden="true">#</a> 1、什么是FSLogix</h2><p>FSLogix是微软免费的Windows用户配置管理解决方案。把用户账户配置从系统里抽象剥离出来，然后使用vhd或vhdx虚拟磁盘文件进行封装，放到一个网络位置，例如SMB共享。用户登录时，系统（具体时FSLogix Agent)会去挂载用户的vhd/vhdx磁盘文件到本地。这样实现了：</p><ul><li>用户配置文件统一管理</li></ul><p>用户配置文件都封装重定向到一个网络位置</p><ul><li>提供了用户体验</li></ul><p>用户配置往往包含一些用户专用应用数据。例如桌面、Chrome收藏夹等。没有配置管理的话，用户配置不会跟着走，如果用户登录多台服务器就会有不同的配置。通过FSLogix可以实现配置跟着走,对用户体验提高很多。</p>',7),d={class:"hint-container tip"},c=i("p",{class:"hint-container-title"},"相比Windows漫游配置文件",-1),g={href:"https://learn.microsoft.com/en-us/fslogix/overview-what-is-fslogix%E3%80%82",target:"_blank",rel:"noopener noreferrer"},u=e('<h2 id="_2-fslogix应用范围" tabindex="-1"><a class="header-anchor" href="#_2-fslogix应用范围" aria-hidden="true">#</a> 2. FSLogix应用范围</h2><p>可以应用到：</p><ul><li>Horizon View 虚拟桌面交付VDA的Instant Cloned自动场部署中;</li><li>Microsoft RDSH (Remote Destkop Server Host)中；</li><li>Citrix桌面交付；</li></ul><h2 id="_3-如何部署" tabindex="-1"><a class="header-anchor" href="#_3-如何部署" aria-hidden="true">#</a> 3. 如何部署</h2><div class="hint-container warning"><p class="hint-container-title">环境要求</p><p>1、需要AD域环境。2、Horizon vSphere/view；3. 存储要求: 如果用户较多,要做好存储容量规划，以及使用的是网络存储，最好是有10GB网络和较快的存储，否则用户登录会很慢，因为通过网络挂载VHDX大文件等。</p></div><h3 id="_3-1-部署到horizon-view自动场-虚拟桌面或rdsh服务器" tabindex="-1"><a class="header-anchor" href="#_3-1-部署到horizon-view自动场-虚拟桌面或rdsh服务器" aria-hidden="true">#</a> 3.1 部署到Horizon View自动场:虚拟桌面或RDSH服务器</h3>',6),x={href:"https://learn.microsoft.com/en-us/fslogix/how-to-configure-storage-permissions#configure-windows-acls",target:"_blank",rel:"noopener noreferrer"},f=e("<li><p>准备自动场的模板虚拟机（安装系统，安装VMWare Tools, 配置DHCP等）</p></li><li><p>在虚拟桌面模板中安装Horizon Agent (安装组件需要选择&quot;Horizon Instant Clone&quot;)，这时不需要注册到Horizon连接服务器；</p></li><li><p>在虚拟桌面模板镜像中(Horizon Agent) 安装FSLogix Agent代理（目前是v2.9）</p></li><li><p>创建快照；</p></li><li><p>准备和配置FSLogix组策略。把FSLogix Bundle安装zip包的组策略文件<code>fslogx.adml</code>和<code>fslogix.admx</code>放到域控的<code>SYSVOL/PolicyDefinitions</code>对应文件夹中。</p></li><li><p>创建1条组策略并链接到Horizon VDA桌面，编辑配置FSLogix组策略。管理模板找到fslogix文件夹，主要配置项有：</p></li>",6),_=e('<ul><li>启用fslogix</li><li>指定配置文件类型为 <strong>VHDX</strong></li><li>配置VHD文件夹位置：指定步骤1准备好的网络共享；</li><li>启用【删除本地配置文件如果成功】；</li><li>指定配置文件大小的上限，默认是30GB；</li></ul><ol start="7"><li>创建Horizon Instant Cloned自动场；</li><li>验证。如果用户能够顺利登录，并观察到网络共享中创建一个VHDX磁盘文件；如下图： <img src="https://imgur.com/a/ftV6fmp" alt="FSLogix Profile Disk" loading="lazy"></li></ol><h3 id="_3-2-部署到horizon-view的手动场-rdsh服务器" tabindex="-1"><a class="header-anchor" href="#_3-2-部署到horizon-view的手动场-rdsh服务器" aria-hidden="true">#</a> 3.2 部署到Horizon View的手动场：RDSH服务器</h3><p>步骤大致同上。不同的、需要注意的是准备RDSH主机模板:</p><ul><li>准备RDSH主机模板时，安装FSLogix Agent；</li><li>准备RDSH主机模板时，<strong>不安装</strong>Horizon Agent；</li><li>需要手动克隆RDSH主机，并使用SysPrep封装每一台RDSH或使用vSphere定制操作系统；</li><li>配置主机名/静态IP地址；</li><li>需要手动安装Horizon Agent，不选择Horizon Instant Clone和Composer。这时，需要输入Horizon连接服务器注册；</li><li>创建Horizon手动场并添加所有RDSH主机；</li></ul><h3 id="_3-3-部署到citrix" tabindex="-1"><a class="header-anchor" href="#_3-3-部署到citrix" aria-hidden="true">#</a> 3.3 部署到Citrix</h3><p>未做（还有环境测试）</p><h1 id="二、应用交付解决方案-horizon-app-volumes" tabindex="-1"><a class="header-anchor" href="#二、应用交付解决方案-horizon-app-volumes" aria-hidden="true">#</a> 二、应用交付解决方案 Horizon App Volumes</h1><h2 id="什么是app-volumes" tabindex="-1"><a class="header-anchor" href="#什么是app-volumes" aria-hidden="true">#</a> 什么是App Volumes</h2><blockquote><p>App Volumes是VMware的应用交付商业解决方案。把应用程序抽象出来封装成为一个VMware Disk(*.VMDK)文件<strong>按需</strong>挂载到用户的虚拟桌面，可以大大降低应用程序部署时间。</p></blockquote><p>好处有：</p><ul><li>因为解耦了应用和系统，提高了部署灵活性。安装一次，然后可以部署到多个服务器；</li><li>可以动态按需部署到不同目标用户和组（AD组）；</li></ul><p><strong>支持应用场景</strong></p><ul><li>Horizon VDI虚拟桌面环境；</li><li>Citrix VDI 虚拟桌面环境；</li></ul><p><strong>App Volumes组件</strong></p><p>组件有：</p><ul><li>App Volumes Manager;</li><li>App Volumes Agent;</li></ul><p><strong>原理</strong></p><ul><li>通过App Volumes Agent录制应用程序安装过程，生成一个应用程序包并把应用程序封装成一个VMDK文件；</li><li>通过App Volumes Agent挂载（附加）VMDK到虚拟桌面本地；</li></ul><h2 id="部署" tabindex="-1"><a class="header-anchor" href="#部署" aria-hidden="true">#</a> 部署</h2><div class="hint-container warning"><p class="hint-container-title">前提要求</p><p>1、需要AD域环境。2、VMware vSphere；3. 存储要求: 如果使用的是网络存储，最好是有10GB网络和较快（有闪存）的存储，否则应用挂载慢等。</p></div><h3 id="如何部署到horizon-vdi虚拟桌面环境" tabindex="-1"><a class="header-anchor" href="#如何部署到horizon-vdi虚拟桌面环境" aria-hidden="true">#</a> 如何部署到Horizon VDI虚拟桌面环境</h3><ol><li>准备一台服务器并安装App Volumes Manager服务器。本例中使用的是App Volumes 2.18。</li><li>配置App Volumes Manager。登录控制台，指定应用程序包VMDK存储位置Datastore和vSphere管理员密码；</li><li>准备1台VMware虚拟机作为应用程序封装的模板计算机(<code>Packaging VM</code>)。操作系统和环境配置最好和后面应用要挂载到的模板虚拟桌面一致。</li><li>在以上Packaging VM上安装App Volumes Agent，安装过程中指定App Volumes Manager服务器地址完成注册；</li><li>立刻给Packaging VM创建一个快照；</li><li>登录App Volumes Manager创建一个AppStack（应用包），并启动【置备provision】来录制应用安装；</li><li>在Packaging VM上应当可以看到一个录制消息框。按照消息框的提示：开始安装应用程序，安装完毕后，才可以点击【OK】完成录制；</li></ol>',23);function V(m,v){const l=t("ExternalLinkIcon");return a(),s("div",null,[p,i("div",d,[c,i("p",null,[o("虽然有点类似用户配置文件漫游,但比Windows漫游配置文件更强，详见官方 "),i("a",g,[o("https://learn.microsoft.com/en-us/fslogix/overview-what-is-fslogix。"),n(l)])])]),u,i("ol",null,[i("li",null,[i("p",null,[o("准备一个网络共享。并设置FSLogix Container的共享和权限。用来放置用户配置VHD/VHDX；权限设置参考："),i("a",x,[o("Configure Windows ACL"),n(l)])])]),f]),_])}const D=r(h,[["render",V],["__file","vmware_horizon_01.html.vue"]]);export{D as default};
